!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Game=n()}(this,function(){"use strict";var r=function(t){function r(t){var n;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,r);var e=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(n=r.__proto__||Object.getPrototypeOf(r)).call.apply(n,[this].concat(function(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}(t||[[0,0,0],[0,0,0],[0,0,0]]))));return e.reset=function(){return e.forEach(function(t,n){return e[n]=[0,0,0]})},Object.defineProperty(e,"winner",{get:function(){for(var t=void 0,n=0,e=0,r=0,i=2;r<=2;r++,i--){switch(n+=this[r][r],e+=this[r][i],3){case Math.abs(n):t=Math.sign(n);break;case Math.abs(e):t=Math.sign(e)}for(var o=0,a=0,s=0;s<=2;s++)switch(o+=this[i][s],a+=this[s][r],3){case Math.abs(o):t=Math.sign(o);break;case Math.abs(a):t=Math.sign(a)}}return t}}),e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(r,Array),r}();var c=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),(n=null!=n?n:{}).p1=void 0!==n.p1&&null!==n.p1?n.p1:"x",n.p2=void 0!==n.p2&&null!==n.p2?n.p2:"o",this[n.p1]=-1,this[n.p2]=1,this[-1]=n.p1,this[1]=n.p2};return function t(n){var e=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.onstart=function(){},this.onnext=function(){},this.onfinish=function(){},n&&(this.onstart=n.onstart||this.onstart,this.onnext=n.onnext||this.onnext,this.onfinish=n.onfinish||this.onfinish);var i=new c(n?n.players:null),o=new r(n?n.board:null),a=this,s=-1,f=function(){var t=o.winner;return t?(e.winner=i[t],e.onfinish(e.winner)):(delete e.winner,t=!1),t};this.reset=function(){return o.reset()},this.next={play:function(t){var n=t.p,e=t.x,r=t.y;if(null!=n&&(r=Math.ceil(n/3)-1,e=n%3),0!==o[r][e])throw new Error("This position has already been played by "+i[o[r][e]]);a.onnext(),o[r][e]=s,this.player=f()||1===s?-1:1}},Object.defineProperty(this.next,"player",{get:function(){return i[s]},set:function(t){s=Number.isNaN(t)||1!==Math.abs(t)?i[t]:t}}),Object.defineProperty(this,"board",{get:function(){return o.map(function(t){return t.map(function(t){return i[t]})})},set:function(t){t.forEach(function(t,e){return t.forEach(function(t,n){return o[e][n]=i[t]})}),f()}}),this.onstart(),f()}});
